# Distance Calculation Feature - Architecture Diagram

## ðŸ—ï¸ Component Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     SelectCinemaActivity                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  onCreate()                                                 â”‚  â”‚
â”‚  â”‚    â”œâ”€> setupToolbar()                                      â”‚  â”‚
â”‚  â”‚    â”œâ”€> setupRecyclerView()                                 â”‚  â”‚
â”‚  â”‚    â””â”€> requestUserLocation() â—„â”€â”                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                    â”‚                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Location Permission Flow                                   â”‚  â”‚
â”‚  â”‚    â”œâ”€> hasLocationPermission() â”€â”€Yesâ”€> getUserLocation()  â”‚  â”‚
â”‚  â”‚    â””â”€> requestLocationPermission() â”€â”€â”                     â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”˜                     â”‚  â”‚
â”‚                                        â”‚                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  onRequestPermissionsResult()                               â”‚  â”‚
â”‚  â”‚    â”œâ”€> Granted â”€â”€> getUserLocation()                       â”‚  â”‚
â”‚  â”‚    â””â”€> Denied  â”€â”€> Show Toast + Continue without location  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  getUserLocation()                                           â”‚ â”‚
â”‚  â”‚    â””â”€> LocationHelper.getCurrentLocation(callback)          â”‚ â”‚
â”‚  â”‚            â”œâ”€> Success: userLatitude, userLongitude         â”‚ â”‚
â”‚  â”‚            â””â”€> Error: hasUserLocation = false               â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  loadShowtimesFromAPI()                                      â”‚ â”‚
â”‚  â”‚    â””â”€> processShowtimesData()                               â”‚ â”‚
â”‚  â”‚            â””â”€> updateShowtimesForDate()                     â”‚ â”‚
â”‚  â”‚                    â””â”€> calculateDistancesAndSort() â—„â”€â”€â”€â”€â”   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”˜ â”‚
â”‚                                                             â”‚     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â” â”‚
â”‚  â”‚  calculateDistancesAndSort()                                â”‚ â”‚
â”‚  â”‚    â”œâ”€> Loop through allCinemas                              â”‚ â”‚
â”‚  â”‚    â”‚     â””â”€> LocationHelper.calculateDistance()            â”‚ â”‚
â”‚  â”‚    â”‚           (Haversine formula)                          â”‚ â”‚
â”‚  â”‚    â”œâ”€> Sort by distance (closest first)                    â”‚ â”‚
â”‚  â”‚    â””â”€> adapter.updateData() + notifyDataSetChanged()       â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      LocationHelper                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  hasLocationPermission()                                    â”‚  â”‚
â”‚  â”‚    â””â”€> Check ACCESS_FINE_LOCATION & ACCESS_COARSE_LOCATION â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  requestLocationPermission(activity)                        â”‚  â”‚
â”‚  â”‚    â””â”€> ActivityCompat.requestPermissions()                 â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  getCurrentLocation(listener)                               â”‚  â”‚
â”‚  â”‚    â”œâ”€> getLastLocation() (fast fallback)                   â”‚  â”‚
â”‚  â”‚    â””â”€> requestLocationUpdates() (accurate GPS)             â”‚  â”‚
â”‚  â”‚           â””â”€> callback: onLocationReceived(lat, lon)       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  calculateDistance(lat1, lon1, lat2, lon2)                  â”‚  â”‚
â”‚  â”‚    â””â”€> Haversine Formula                                    â”‚  â”‚
â”‚  â”‚          â€¢ Convert to radians                               â”‚  â”‚
â”‚  â”‚          â€¢ Calculate angular distance                       â”‚  â”‚
â”‚  â”‚          â€¢ Return distance in km                            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  formatDistance(distance)                                   â”‚  â”‚
â”‚  â”‚    â”œâ”€> < 1 km  â”€â”€> "XXX m"                                 â”‚  â”‚
â”‚  â”‚    â””â”€> >= 1 km â”€â”€> "X.X km"                                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    SelectCinemaAdapter                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  CinemaViewHolder.bind()                                    â”‚  â”‚
â”‚  â”‚    â”œâ”€> Set cinema name                                      â”‚  â”‚
â”‚  â”‚    â””â”€> Display distance                                     â”‚  â”‚
â”‚  â”‚          â”œâ”€> cinema.getDistance()                           â”‚  â”‚
â”‚  â”‚          â”œâ”€> LocationHelper.formatDistance()                â”‚  â”‚
â”‚  â”‚          â””â”€> tvCinemaDistance.setText() + setVisibility()  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ðŸ”„ Data Flow Sequence

```
User Opens SelectCinemaActivity
          â”‚
          â–¼
  requestUserLocation()
          â”‚
          â”œâ”€â”€â”€â”€ Permission Already Granted?
          â”‚           â”‚
          â”‚          Yes â”€â”€> getUserLocation()
          â”‚           â”‚              â”‚
          â”‚          No â”€â”€â”          â–¼
          â”‚               â”‚   FusedLocationProvider
          â”‚               â”‚          â”‚
          â”‚               â–¼          â”œâ”€> Last Known Location
          â”‚     Request Permission   â”‚
          â”‚               â”‚          â””â”€> Current Location Request
          â”‚               â”‚                     â”‚
          â”‚         â”Œâ”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”              â”‚
          â”‚         â”‚           â”‚              â”‚
          â”‚      Granted     Denied            â”‚
          â”‚         â”‚           â”‚              â”‚
          â”‚         â”‚      Show Toast          â”‚
          â”‚         â”‚           â”‚              â”‚
          â”‚         â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜              â”‚
          â”‚                â”‚                   â”‚
          â–¼                â–¼                   â–¼
    Load Showtimes     Continue        onLocationReceived
          â”‚           without          (latitude, longitude)
          â”‚           location                 â”‚
          â”‚                â”‚                   â”‚
          â–¼                â”‚                   â”‚
  processShowtimesData     â”‚                   â”‚
          â”‚                â”‚                   â”‚
          â–¼                â”‚                   â”‚
  updateShowtimesForDate   â”‚                   â”‚
          â”‚                â”‚                   â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
              calculateDistancesAndSort()
                           â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚                â”‚                â”‚
      Cinema 1         Cinema 2        Cinema 3
          â”‚                â”‚                â”‚
          â”œâ”€> Haversine    â”œâ”€> Haversine   â”œâ”€> Haversine
          â”‚   Formula       â”‚   Formula     â”‚   Formula
          â”‚                â”‚                â”‚
          â”œâ”€> 2.5 km       â”œâ”€> 3.8 km      â”œâ”€> 15.2 km
          â”‚                â”‚                â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                           â–¼
                 Sort by Distance
                  (Ascending Order)
                           â”‚
                           â–¼
                  Update Adapter
                           â”‚
                           â–¼
              Display in RecyclerView
                  with Distance Badges
```

## ðŸ“± UI Component Hierarchy

```
SelectCinemaActivity
    â”‚
    â”œâ”€> Toolbar
    â”‚     â””â”€> Title: Movie Name
    â”‚
    â”œâ”€> Date Spinner (HorizontalScrollView)
    â”‚     â””â”€> Date Chips (Today, Tomorrow, etc.)
    â”‚
    â”œâ”€> Cinema Filter Spinner
    â”‚     â””â”€> "Táº¥t cáº£ chi nhÃ¡nh" or specific cinema
    â”‚
    â”œâ”€> RecyclerView (Cinema List)
    â”‚     â”‚
    â”‚     â””â”€> item_cinema_showtime.xml (per cinema)
    â”‚           â”‚
    â”‚           â”œâ”€> MaterialCardView
    â”‚           â”‚     â”‚
    â”‚           â”‚     â””â”€> LinearLayout (Vertical)
    â”‚           â”‚           â”‚
    â”‚           â”‚           â”œâ”€> Cinema Header (Horizontal)
    â”‚           â”‚           â”‚     â”‚
    â”‚           â”‚           â”‚     â”œâ”€> ImageView (Location Icon)
    â”‚           â”‚           â”‚     â”‚     â””â”€> ic_location (18dp)
    â”‚           â”‚           â”‚     â”‚
    â”‚           â”‚           â”‚     â”œâ”€> TextView (Cinema Name)
    â”‚           â”‚           â”‚     â”‚     â””â”€> "Galaxy Nguyá»…n Du"
    â”‚           â”‚           â”‚     â”‚          (weight=1, bold, 16sp)
    â”‚           â”‚           â”‚     â”‚
    â”‚           â”‚           â”‚     â”œâ”€> TextView (Distance) â—„â”€â”€ NEW!
    â”‚           â”‚           â”‚     â”‚     â””â”€> "2.5 km"
    â”‚           â”‚           â”‚     â”‚          (12sp, badge style)
    â”‚           â”‚           â”‚     â”‚
    â”‚           â”‚           â”‚     â””â”€> ImageView (Expand Icon)
    â”‚           â”‚           â”‚           â””â”€> ic_expand_more (24dp)
    â”‚           â”‚           â”‚
    â”‚           â”‚           â””â”€> LinearLayout (Showtimes Container)
    â”‚           â”‚                 â””â”€> Dynamically populated
    â”‚           â”‚                     when expanded
    â”‚           â”‚
    â”‚           â””â”€> Expand/Collapse Animation
    â”‚
    â””â”€> Empty State Layout
          â””â”€> "Hiá»‡n táº¡i chÆ°a cÃ³ lá»‹ch chiáº¿u"
```

## ðŸ§© Class Relationships

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SelectCinemaActivity   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ uses
           â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚             â”‚                 â”‚
    â–¼             â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Adapter â”‚  â”‚LocationHelperâ”‚  â”‚Repositoryâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚             â”‚                 â”‚
    â”‚ displays    â”‚ calculates      â”‚ provides
    â”‚             â”‚                 â”‚
    â–¼             â–¼                 â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Cinema â”‚  â”‚  Distance    â”‚  â”‚Showtimes â”‚
â”‚ Model  â”‚  â”‚  (Haversine) â”‚  â”‚   API    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ðŸ”¢ Haversine Formula Visualization

```
Given two points on Earth:
  Point A (User):    lat1, lon1
  Point B (Cinema):  lat2, lon2

Calculate:
  Î”lat = lat2 - lat1
  Î”lon = lon2 - lon1

Haversine Formula:
  a = sinÂ²(Î”lat/2) + cos(lat1) Ã— cos(lat2) Ã— sinÂ²(Î”lon/2)
  c = 2 Ã— atan2(âˆša, âˆš(1-a))
  distance = Earth_Radius Ã— c

Where Earth_Radius = 6371 km

Example:
  User:   10.8231Â° N, 106.6297Â° E (HCMC)
  Cinema: 10.7629Â° N, 106.6821Â° E (District 1)
  
  Result: ~7.8 km
```

## ðŸ“Š State Management

```
SelectCinemaActivity States:

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Location State                         â”‚
â”‚  â”œâ”€> hasUserLocation: boolean           â”‚
â”‚  â”œâ”€> userLatitude: double               â”‚
â”‚  â””â”€> userLongitude: double              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Cinema Data State                      â”‚
â”‚  â”œâ”€> allCinemas: List<Cinema>           â”‚
â”‚  â”œâ”€> showtimesByDateMap: Map<>          â”‚
â”‚  â””â”€> showtimesData: Response            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  UI State                               â”‚
â”‚  â”œâ”€> expandedPosition: int              â”‚
â”‚  â”œâ”€> selectedDate: String               â”‚
â”‚  â””â”€> selectedCinema: int                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

State Transitions:
  LOADING -> PERMISSION_REQUEST -> LOCATION_ACQUIRED -> CALCULATING -> DISPLAYING
```

---

**Created**: January 2025  
**Last Updated**: January 2025  
**Version**: 1.0
